{"crypto": [{"name": "Breaking AES", "desc": "Can you break AES and capture the flag?\n\n    nc aes.uctf.ir 7001\n\nServer source code\n\nimport logging\n\nimport os\nimport random\nimport time\nimport base64\n\nimport asyncio\nfrom asyncio import StreamReader, StreamWriter, TimeoutError\n\nfrom Crypto.Cipher import AES\n\nclass CryptorServer:\n    MAX_INPUT_LEN = 64\n    IV_LEN = 8\n\n    def __init__(self, key: str, flag: str, host: str = '0.0.0.0', port: int = 7000, timeout: float = 8) -> None:\n        self.host = host\n        self.port = port\n        self.timeout = timeout\n\n        self.__key = bytes.fromhex(key)\n        self.__flag = flag.encode('utf-8')\n\n    async def run(self) -> None:\n        server = await asyncio.start_server(self.__client_handler, host=self.host, port=self.port)\n        await server.serve_forever()\n\n    def __encrypt(self, message: bytes) -> bytes:\n        random.seed(int(time.time()) * len(message))\n        nonce = random.randbytes(CryptorServer.IV_LEN)\n\n        cipher = AES.new(self.__key, AES.MODE_CTR, nonce=nonce)\n        ciphertext = cipher.encrypt(message)\n\n        return base64.b64encode((nonce + ciphertext)) + b'\\n'\n\n    async def __client_handler(self, reader: StreamReader, writer: StreamWriter) -> None:\n        peer_ip, peer_port = writer.get_extra_info('peername')\n        peer_name = f'[{peer_ip}]:{peer_port}'\n\n        logging.info(f'New session for {peer_name}')\n        try:\n            writer.write(b'Encrypted flag: ' + self.__encrypt(self.__flag))\n            writer.write(b\"Give me a message and I'll encrypt it for you: \")\n            await writer.drain()\n\n            user_input = (await asyncio.wait_for(reader.readline(), self.timeout)).strip()\n            if len(user_input) < CryptorServer.MAX_INPUT_LEN:\n                enc = self.__encrypt(user_input.strip())\n                writer.write(enc)\n                await writer.drain()\n        except TimeoutError:\n            logging.warning(f'{peer_name} timed-out')\n            return\n        except ConnectionError:\n            logging.warning(f'Connection error occurred for {peer_name}')\n            return\n        finally:\n            logging.info(f'Session finished for {peer_name}')\n            writer.close()\n\nif __name__ == '__main__':\n    logging.basicConfig(level=logging.INFO)\n\n    flag = os.environ['CRYPTOR_FLAG']\n    key = os.environ['CRYPTOR_KEY']\n\n    server = CryptorServer(key, flag)\n    try:\n        asyncio.run(server.run())\n    except KeyboardInterrupt:\n        logging.info('Bye bye!')\n"}, {"name": "Insiders Secret", "desc": "\"Craving a peek into my mysterious identity vault? Flex your decryption muscles and tackle this challenge:\"\nVm14V1QxWldTblZqTTJoWlpXeEtNRmRJY0VaTlIwWTJWRzFhYTFaRmNEQlVWbEpUVDFFOVBRPT0=\n"}, {"name": "License Please", "desc": "https://lplz.uctf.ir\nCan you get a valid license and capture the flag? Source of the site is attached.\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/crypto/License_Please/getlicense.php", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/crypto/License_Please/index.html", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/crypto/License_Please/validate.php"]}, {"name": "Noql", "desc": "I'm encrypted. try to break me!\nif you need a key anywhere use this \"CT0cgUTU7gBBvA3DOk4H30JMQSFwNm-viqZm9eDwPK8=\"\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/crypto/Noql/noql.txt"]}], "forensic": [{"name": "Deleted Message", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/forensic/Deleted_Message/.layout_version", null, null, null, null, null, null, null, null, null, null, null, null], "desc": "Cyber Police have seized a computer containing illegal content, but the data stored is secured with a password.\n\nA member of the criminal organization owning the computer was arrested. Police suspect that the password was sent to the criminal via SMS, but the message was deleted right before the arrest.\n\nYou\u2019re given a dump of the data partition of the phone (running Android 6.0). Your job as the forensic specialist is to recover the deleted password.\n"}, {"name": "HTTPS Decryption", "desc": "In this challenge, you are provided with a file containing captured network packets and a file containing master keys. Your task is to decrypt the HTTPS traffic and find the flag hidden within the decrypted data. The target domain for this challenge is mrgray.xyz. Good luck!\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/forensic/HTTPS_Decryption/captured_packets.pcapng.xz", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/forensic/HTTPS_Decryption/master_keys.log"]}, {"name": "Hidden Streams", "desc": "Explore the available streams and consider the different types of data that can be associated with a single filename. Good luck!\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/forensic/Hidden_Streams/stream-ctf.vhd"]}, {"name": "Network Punk", "desc": "Some cyberpunk hide the flag inside a network traffic. We have dumped the traffic. Your task is to find the flag to save the city.\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/forensic/Network_Punk/traffic.pcap.xz"]}], "misc": [{"name": "Appellations", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/misc/Appellations/Information.mp3", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/misc/Appellations/Message.wav"], "desc": "Situated between East and West Azarbaijan provinces, Lake Urmia was renowned as the largest saltwater lake across the Middle East. Throughout the past century, it garnered various significant designations. However, within this challenge, the focus lies on unearthing one of its most splendid titles. Your task: decipher the contemporary identity that adorns Lake Urmia today. Note that the flag should be in this format: UCTF{flag}\n"}, {"name": "Farewell", "desc": "One of our challenge designers - The Leonardo - is into math. We asked him to create a math challenge, but he sent us this video, and he is not answering our calls.\nhere is the challenge anyways, maybe you can figure it out :)\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/misc/Farewell/video.mp4"]}, {"name": "LendingPool", "desc": "Welcome to the LendingPool challenge! In this challenge, you'll be diving into a pool that offers flash loans of CTF tokens for free. The pool currently holds a balance of 1 million CTF tokens, while you start with nothing. However, there's no need to worry \u2013 you just might have what it takes to acquire them all from the pool.\nLendingPool\n\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n\nimport {IERC20} from \"@openzeppelin/contracts/token/ERC20/IERC20.sol\";\nimport {ReentrancyGuard} from \"@openzeppelin/contracts/security/ReentrancyGuard.sol\";\n\n\ncontract LendingPool is ReentrancyGuard {\nIERC20 public ctfToken;\n\n\nconstructor(address tokenAddress) {\n    ctfToken = IERC20(tokenAddress);\n}\n\n\nfunction flashLoan(uint256 borrowAmount, address borrower, address target,          bytes calldata data)\nexternal\nnonReentrant\n{\n    uint256 balanceBefore = ctfToken.balanceOf(address(this));\n    require(balanceBefore >= borrowAmount, \"Not enough tokens in pool\");\n\n\n    ctfToken.transfer(borrower, borrowAmount);\n    (bool success,) = target.call(data);\n    require(success, \"External call failed\");\n\n\n    uint256 balanceAfter = ctfToken.balanceOf(address(this));\n    require(balanceAfter >= balanceBefore, \"Flash loan hasn't been paid back\");\n}\n\n\nfunction isSolved() public view returns (bool) {\n    return ctfToken.balanceOf(address(this)) == 0;\n}\n}\n\nCTF Token\n\nhttps://mumbai.polygonscan.com/address/0xfa8994aa87c97e291dc8f08d88d76a1c623474d7\n\nNote: To participate in this challenge, please ensure you possess Mumbai Testnet Matic tokens. https://mumbaifaucet.com/\n\nThe website is available at: https://lending.uctf.ir/\n"}, {"name": "OTP Onion Transfer Protocol", "desc": "This CTF question focuses on finding the flag from a hidden FTP server behind Tor. You will need the following credentials:\n\nUsername: myuser\nPassword: mypass\n\nThe hidden service can be accessed at the following address using the default port (21):\n\notpxxwpvfjume6kdlii5gcghgg53lj7gnl7hoigg4sx2wc45xwasw7id.onion\n\nHowever, beware! There are numerous booby traps lurking within the dark corners.\n\nThere are some limits, you can only send the flag 3 times. So send the flags precisely\n\nThe FTP server has some limits. One connection is enough for solving the challenge.\n"}, {"name": "Unlock", "desc": "Welcome to the Unlock challenge, an intriguing journey into the realm of Solidity smart contracts where the quest for knowledge leads to a concealed flag. As you embark on this cryptic adventure, you'll navigate through the intricacies of the Unlock contract, carefully unraveling its secrets to reveal the hidden key to success.\n\nYour mission is clear: decipher the enigmatic flag, ingeniously hidden within the depths of the contract's data. The flag is a clever construction, waiting to be unveiled through the concatenation of three specific elements: data[0], FLAG, and data[1]. Cracking this code showcases your mastery of the challenge, serving as a testament to your cryptographic prowess.\n\n// SPDX-License-Identifier: MIT pragma solidity ^0.8.0;\n\ncontract Unlock { address public OWNER; bool public isDeployed = true; uint16 public u16 = 18; uint256 private immutable MONTH; bytes32 private FLAG; uint256 public constant YEAR = 2023; bytes32[3] public data;\n\nconstructor(bytes32 _flag, bytes32 _data, bytes32 _data2) {\n    OWNER = msg.sender;\n    MONTH = 8;\n    FLAG = _flag;\n    data[0] = _data;\n    data[1] = _data2;\n}\n\n} Contract Address: 0xaF3bC055023Cb9A869083F5A6C126Df1c605Ad7a\n\nhttps://mumbai.polygonscan.com/address/0xaf3bc055023cb9a869083f5a6c126df1c605ad7a\n\nNote: To participate in this challenge, please ensure you possess Mumbai Testnet Matic tokens.\n\nhttps://mumbaifaucet.com/\n"}], "pwn": [{"name": "moedo", "desc": "We've created a moe alternative to sudo called moedo.\n\nIf you can bypass its moe secuirty you'll be awarded with the flag!\n\n    telnet moe.uctf.ir 7002\n    Username: mashiro\n    Password: Qh3VRn@23jv43Q\n\nmoedo source code:\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <grp.h>\n\n#define MOE_ENOUGH 0x30e\n\nint check_moe(int uid)\n{\n    struct group *moe_group = getgrnam(\"moe\");\n    int moeness = 0;\n\n    int ngroups;\n    gid_t *groups;\n\n    if (moe_group == NULL)\n        return 0;\n\n    ngroups = getgroups(0, NULL);\n    groups = malloc(ngroups * sizeof(*groups));\n    getgroups(ngroups, groups);\n    for (int i = 0; i < ngroups; i++)\n    {\n        if (groups[i] == moe_group->gr_gid)\n        {\n            moeness = MOE_ENOUGH;\n            break;\n        }\n    }\n\n    free(groups);\n    return moeness;\n}\n\nint main(int argc, char *argv[])\n{\n    uid_t uid = getuid();\n    uid_t gid = getgid();\n    int moeness = check_moe(uid);\n\n    char *custom_chant = getenv(\"MOE_CHANT\");\n    char chant[] = \"Moe Moe Kyun!\";\n\n    if (argc < 2)\n    {\n        fputs(\"Missing command\\n\", stderr);\n        return 1;\n    }\n\n    if (custom_chant)\n        strcpy(chant, custom_chant);\n\n    printf(\"UID: %u - GID: %u - Moe: %x\\n\", uid, gid, moeness);\n\n    if (moeness != MOE_ENOUGH)\n    {\n        fputs(\"You're not moe enough!\\n\", stderr);\n        return 1;\n    }\n\n    if (setuid(0) != 0)\n    {\n        perror(\"setuid() failed\");\n        return 1;\n    }\n    if (setgid(0) != 0)\n    {\n        perror(\"setgid() failed\");\n        return 1;\n    }\n\n    puts(chant);\n\n    if (execvp(argv[1], &argv[1]) != 0)\n    {\n        perror(\"execv() failed\");\n        return 1;\n    }\n\n    return 0;\n}\n"}], "rev": [{"name": "Flutter QRCode", "desc": "There is a BOMB in city hall and a code (flag) to disarm the BOMB is hidden in this Application. Your goal is to find this flag to save the city.\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/rev/Flutter_QRCode/qrCode.apk"]}, {"name": "Project Meme", "desc": "There are three parts of the flag hide by tacocat. Look precisely to find and gather them all to find the complete flag.\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/rev/Project_Meme/TacocaT.apk"]}, {"name": "Very Super Mario", "desc": "Mario tries to save the princess but there are lots of Bowsers in the way. They also protect the flag. Find the flag among the Bowsers.\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/rev/Very_Super_Mario/VerySuperMario.apk"]}], "steg": [{"name": "Deb File The Old Systems", "desc": "Can you believe it? people still use linux? after the emerge of Evil E computers, nobody bothered to use linux systems. anyways, we got this file from database gaurds' pc, can you help us?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/steg/Deb_File_The_Old_Systems/uctfdeb-0.0.1.deb"]}, {"name": "Dorna", "desc": "I'm hiding somewhere. Find me if you can!!\n\nif you need a password anywhere use this \"urumdorn4\"\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/UCTF/2023/steg/Dorna/dorna.jpg"]}]}