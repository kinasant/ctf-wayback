{"crypto": [{"name": "Cookmaster 1", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Cookmaster_1/Dockerfile", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Cookmaster_1/docker-compose.yml", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Cookmaster_1/get_token.py", null], "desc": "It's the potluck season again! But as every year, that damn dude Jerry brought his special Cookmaster and is stealing the show with his secret sauce! But not this year. It's time to teach him a lesson! Can you steal the recipe for his secret sauce and corrupt his Cookmaster to put a bad taste to his food?\nYou even bought your own Cookmaster to try everything before you can pull of your heist during the potluck!\nFlag 1: Can you access the system and extract the secret sauce? Flag 2: Great, you got system access! Now all that\u2019s left to do, hack the system and corrupt the heater to grill his sauce!\n\n\n# cookmaster - Potluck CTF 2023\n\nStarting the interface from the root folder with `docker compose up`\nshould set everything up out of the box, and open a web interface on\nlocalhost at port 31337. You might have to `modprobe vcan` (e.g. on\nUbuntu this requires you installing extra kernel modules)\nand `modprobe vxcan` and some shenanigans for running the\ndocker-in-docker setup.\n"}, {"name": "Cookmaster 2", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Cookmaster_2/Dockerfile", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Cookmaster_2/docker-compose.yml", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Cookmaster_2/get_token.py", null], "desc": "It's the potluck season again! But as every year, that damn dude Jerry brought his special Cookmaster and is stealing the show with his secret sauce! But not this year. It's time to teach him a lesson! Can you steal the recipe for his secret sauce and corrupt his Cookmaster to put a bad taste to his food?\nYou even bought your own Cookmaster to try everything before you can pull of your heist during the potluck!\nFlag 1: Can you access the system and extract the secret sauce? Flag 2: Great, you got system access! Now all that\u2019s left to do, hack the system and corrupt the heater to grill his sauce!\n\n\n# cookmaster - Potluck CTF 2023\n\nStarting the interface from the root folder with `docker compose up`\nshould set everything up out of the box, and open a web interface on\nlocalhost at port 31337. You might have to `modprobe vcan` (e.g. on\nUbuntu this requires you installing extra kernel modules)\nand `modprobe vxcan` and some shenanigans for running the\ndocker-in-docker setup.\n"}, {"name": "Upside down Cake", "desc": "Let's bake a cake -- an upside-down cake full of secrets! Ready to flip the script?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/Upside_down_Cake/upside_down_cake.py"]}, {"name": "abc", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/abc/Cargo.lock", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/abc/Cargo.toml", null], "desc": "Alice, Bob, and Charlie are coordinating a potluck.\n"}, {"name": "lima beans with lemon and lime", "desc": "It was just yesterday when I was making my favorite dish (lima beans with lemon and lime) that I realised I could turn my favorite dish (lima beans with lemon and lime) into a unpenetrable cryptosystem 32 times stronger than AES.\nI, of course immediately patented the cryptosystem so that other people could not steal my idea.\nI will let you try out my cryptosystem, but you will only be allowed to encrypt data, not decrypt it, so that you can\\'t steal my cryptosystem.\nIf you find any vulnerability with the cryptosystem then please send me proof by decrypting the flag.\nIn the words of my grandfather (Albert Einstein)\n\"\"Man I love lima beans with lemon and lime, also PoC || GTFO\"\"\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/crypto/lima_beans_with_lemon_and_lime/final.py"]}], "misc": [{"name": "Emacro wave cooking", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/Emacro_wave_cooking/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/Emacro_wave_cooking/chall.py", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/Emacro_wave_cooking/compose.yaml", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/Emacro_wave_cooking/config.el"], "desc": "Why did the Emacs user bring a keyboard to the restaurant? They wanted to have a \"Ctrl\" over their spaghetti code!\n"}, {"name": "Shell No Evil", "desc": "> Due to the special background of the R&D unit of Sunway CPU, the SW64 instruction set has not been made public so far. Although non-disclosure of the instruction set is very detrimental to the construction of the software ecosystem, it also prevents malicious attackers from writing shellcode targeting Sunway processors, and the product has extremely high self-security. [1]\n\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\ud83e\udd23\nSurely writing shellcode for an \"\"unknown\"\" architecture is impossible, right, right???\nNote: Flag located at /flag_(a random uuid), there is no /bin/sh.\n[1] Machine translated, source: https://k-sina-cn.translate.goog/article_5952916295_162d24b47019001k3l.html?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=zh-CN&_x_tr_pto=wapp\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/Shell_No_Evil/challenge.c"]}, {"name": "tacocat", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/tacocat/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/misc/tacocat/main.py"], "desc": "We weren't sure what to bring to the potluck, but we figured another pyjail would always be welcome.\n"}], "pwn": [{"name": "Ezrop", "desc": "Pretty standard ret2libc pwn challenge.\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Ezrop/ezrop", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Ezrop/libc.so.6"]}, {"name": "Pot Of Gold", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Pot_Of_Gold/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Pot_Of_Gold/chall", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Pot_Of_Gold/flag.txt", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Pot_Of_Gold/gordon.bin", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Pot_Of_Gold/kitchen.bin", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Pot_Of_Gold/run.sh"], "desc": "You are tasked to help out in the kitchen of the elusive g0rd0n r4ms4y. This rude chef needs to be put in his place real bad! Show us you're an elite chef and attempt a coup of his little kitchen.\n"}, {"name": "Schrodingers P1G", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Schrodingers_P1G/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Schrodingers_P1G/myP1G"], "desc": "A Virtual Machine containing a poor pig. And 0 and 1\n"}, {"name": "Tamagoyaki", "desc": "Tamagoyaki (literally 'grilled egg') is a Japanese omelette crafted by rolling layers of fried, beaten eggs.\nTamagoyaki shares similarities with glibc's malloc, as it also contains several layers of fried and beaten code.\nNote: Expect 4 bits of bruteforce; Anything above that is probably a bad idea\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Tamagoyaki/chal", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Tamagoyaki/ld-linux-x86-64.so.2", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/Tamagoyaki/libc.so.6"]}, {"name": "auxv", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/0001-Store-the-open-file-descriptors-of-the-process-in-it.patch", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/Dockerfile.build_system", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/debugging-goodies.patch", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/docker-compose.yml", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/flag", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/init", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/potluck.config", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/auxv/run.sh"], "desc": "Connect to the remote server with `nc -nv challenge09.play.potluckctf.com 31337`. For detailed instructions, see README.md in the provided challenge09-dist.tgz file.\n\n\n### Setup\n\nFinding and closing all currently open file descriptors on Linux is not easy.\nI mean, just look at [this library](https://github.com/cptpcrd/close_fds).\nSo, I wrote a simple kernel patch that allows you to enumerate currently\nopen file descriptors from userspace.\n\nI did my best to ensure this patch is memory-safe, so it should definitely\n*NOT* introduce any new security vulerabilities such as, say, local privilege\nescalation to root.\n\nTo prove this, I'm giving you an unprivileged shell on a system with\na secret file (`/flag`) that is only readable by root. If I did my job\nproperly, you should *NOT* be able to access it.\n\n### How to hack\n\nInstall `qemu-system-x86_64` and launch `./run.sh` from the directory with this README.\nIf your exploit works in this local setup, it should also work on the remote.\n\nYou can also run `docker compose up` from the directory with this README to re-create the\nexact setup the remote server runs (the server will listen locally on port 31337). This is\nbasically `run.sh` with TCP connection handling and some proof-of-work slapped on top.\n\nPro tip: use `base64` to deliver binaries/exploits to the remote.\nE.g., on a local machine with Wayland:\n```\n$ musl-gcc -O2 -static -o pwn pwn.c && base64 pwn | wl-copy\n```\n\nOn the remote:\n```\n$ base64 -d >/tmp/pwn <<EOF && chmod +x /tmp/pwn && /tmp/pwn\n[...PASTE THE CONTENTS OF YOUR BUFFER HERE...]\nEOF\n```\n\n### How to hack harder\n\nThe challenge environment (kernel/initramfs) used by `run.sh` is located in `prebuilt_system/`.\nYou can run `docker build --output=prebuilt_system --target=output -f Dockerfile.build_system .`\nto (hopefully) re-create the prebuilt files exactly.\n\nFor smooth debugging experience, run the following:\n```\n$ patch -p1 < debugging-goodies.patch\n$ docker build --output=custom_system --target=output -f Dockerfile.build_system .\n```\n\nThis will create an environment suitable for debugging in `custom_system/`:\n  * `gdb` will be installed in the guest system for userspace debugging\n  * the kernel will be recompiled with various debugging options\n\nThe `run.sh` will be modified so that it uses the new environment and awaits\na `gdb` connection from the host before starting the guest. To connect with\n`gdb` from the host:\n  * cd to `custom_system/`\n  * run `tar xf src.tar` to unpack the kernel sources\n  * run `gdb vmlinux`\n  * type `target remote :1234` and `c` in `gdb`\n  * enjoy debugging the kernel with symbols and source code\n"}, {"name": "bear err", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/Makefile", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/base64.c", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/base64.h", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/base64.o", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/signature.c", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/signature.h", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/signature.o", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/simple", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/simple.c", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/bear_err/simple.o"], "desc": "People always say crypto is so hard, but I'm sure I didn't fuck up there. Parsing JSON is super easy too, just use strtok.\n"}, {"name": "sandboxes", "desc": "With our state-of-the-art sandbox, you can nuke anything without any worries. Can you get the flag though?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/sandboxes/initramfs.cpio.gz", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/sandboxes/kernel", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/sandboxes/run.sh", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/sandboxes/user.cpio.gz"]}, {"name": "sekurbut", "desc": "hardware\n\n\nThe previous owner of the arcade machine still has a trace of the firmware update. Maybe there's a way to run your own firmware?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/pwn/sekurbut/update.sal"]}], "rev": [{"name": "Charming Circuit Challenge", "desc": "Last week I had a fever dream about Brian Silverman's excessive love of Christmas lights. When I came to my senses this program was on my computer. I don't know what it does. Can you help me?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/rev/Charming_Circuit_Challenge/charming-circuit-challenge"]}, {"name": "GACHAAAAAtkr", "desc": "Wow it's another gacha game... but everything is so expensive! Everyone's showing off their characters, but I don't have any. Would be a shame if there was a cheat code that could give me some!\nThanks to enscribe (https://enscribe.dev) for the assets used in the game!\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/rev/GACHAAAAAtkr/release.7z"]}, {"name": "REhoST", "desc": "Our development team created a secure way of booting firmware by authenticating against a different chip. We have the firmware, however we don't have the secure chip at hand :c Can you help us by emulating the secure processor so that we can boot our firmware?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/rev/REhoST/firmware", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/rev/REhoST/peripheral"]}], "web": [{"name": "Traditional Feast Nginx Spagetthi", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/Traditional_Feast_Nginx_Spagetthi/Dockerfile", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/Traditional_Feast_Nginx_Spagetthi/docker-compose.yml", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/Traditional_Feast_Nginx_Spagetthi/package.json", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/Traditional_Feast_Nginx_Spagetthi/pnpm-lock.yaml", null, null], "desc": "Imagine a world where your code soars on the performance of nginx, dancing gracefully with modern scripting and transformation powers. While PHP aficionados are still trying to figure out their 500 internal errors and CGI fans are busy scripting their way to the last century, you'll be light-years ahead, sipping espresso and deploying functionalities like it's nobody's business.\n"}, {"name": "savaoury", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/savaoury/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/savaoury/build.sh", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Potluck/2023/web/savaoury/readflag.c"], "desc": "TODO\n"}]}