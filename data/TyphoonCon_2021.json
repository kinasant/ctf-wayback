{"pwn": [{"name": "Chrome Sandbox Escape", "desc": "In this challenge, you will attempt to escape the Chrome sandbox on Linux and achieve control of the Browser process.\nSetup\n\nYou are provided with a modified Chrome version, with an added vulnerability and several utilities to simulate a compromised renderer process.\n\nThe vulnerability is in a new mojo interface named Hack, which allows the renderer to allocate and free regions of memory, and read from them. However, reads are not bound-checked, allowing for information disclosure. The interface is described in hack.mojom as:\n\ninterface Hack {\n    Allocate(uint64 size) => (uint64 id);\n    Free(uint64 id) => ();\n    Read(uint64 id, uint64 offset, uint64 size) => \n        (array<uint8> bytes);\n}\n\nAn exampletory use of this vulnerability, using MojoJS:\n\nvar hack_ptr = new blink.mojom.HackPtr();\nMojo.bindInterface(blink.mojom.Hack.name, mojo.makeRequest(hack_ptr).handle)\n\nasync function foo() {\n    let allocation = await hack_ptr.allocate(10);\n    data = await hack_ptr.read(allocation.id, 100, 10);\n    console.log(data.bytes); // Will print 10 bytes from offset 100 of the allocation\n}\nfoo();\n\nIn addition, to simulate control of the renderer, the following utilities are available:\n\n    getaddress(object) - takes a single argument that is an object, and returns its address as a BigInt\n    readwrite(BigInt base) - returns a large ArrayBuffer, whose data is at address base.\n    callforeign(BigInt function_address, BigInt arg1, ...) - calls a native function at function_address with arguments arg1, ... (up to 4 arguments). The return value of the function is returned as a BigInt.\n    dlopen(string library_name) - Gets the address of a loaded library. The returned BigInt may be passed as a handle to dlsym. Note that the sandbox will not allow loading a library that is not already loaded. To help you load your own library, dlopen(\"./libhack.so\", RTLD_NOW) is executed before the sandbox is initialized, so you may use dlopen(\"./libhack.so\") in JS to access your own library.\n    dlsym(BigInt handle, string symbol_name) - Get the address of a symbol as a BigInt.\n    MojoJS is enabled by default.\n\nAllowed modifications\n\nIn addition to the utilities listed above, you may choose to introduce additional patches to Chrome to aid in exploitation, as long as they affect the renderer process only.\nSuccess Criteria\n\nTo win the challenge, you must demonstrate complete control of the browser process by executing arbitrary code. You may also submit partial solutions that achieve some exploit capability short of full control (such as a limited write capability, or a UaF). If no winner is selected, a partial score may be awarded for a partial solution.\n\nSolutions will be judged on Ubuntu 18.04, and must achieve the desired result with reliability > 51%.\n\nYour solution must be based on novel research. In particular, do not use recently fixed security issues that may not be fixed in the challenge Chrome version.\nSubmission\n\nA submission should include any code used in the exploit:\n\n    HTML/JS files\n    Source code for libhack.so if used\n    Any additional renderer patches\n\nGeneral Narrative\n\nThe point of this challenge is to prove the probability of exploiting an info-leak. We hope you guys show good spirit and intentions :)\nPackage\n\nTo make it easier for you to win this challenge we have precompiled everything and are providing everything in a file (6GB): (deprecated, use new link) https://typhooncon.s3.us-east-2.amazonaws.com/Chrome+Compilation.zip\n\nUpdated link: https://typhooncon.s3.us-east-2.amazonaws.com/New+Chrome+Compilation.zip\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/pwn/Chrome_Sandbox_Escape/chrome.diff", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/pwn/Chrome_Sandbox_Escape/test.html", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/pwn/Chrome_Sandbox_Escape/v8.diff"]}], "rev": [{"name": "Building a House", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Building_a_House/chal.html", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Building_a_House/chal.js", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Building_a_House/chal.wasm"]}, {"name": "Debug Or Me", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Debug_Or_Me/MaxDebugger", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Debug_Or_Me/docker_deploy.sh", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Debug_Or_Me/program.py", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Debug_Or_Me/startup.sh"], "desc": "Can you debug me and find the flag?\n\nNOTE You need to deploy your own dockerized version of the challenge and create a fake flag file.\n\nExpected solution Python (3.x or 2.7) script that runs and connects to the challenge program and obtains the flag\n\nSolutions Email the solution to info@typhooncon.com - we will be providing fully working submissions with the relevant points according to the timestamp when the working submissions was sent to us.\n"}, {"name": "Exciting Offer", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Exciting_Offer/Offer_details.doc", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Exciting_Offer/encrytped_flag.txt"]}, {"name": "Knock Knock", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Knock_Knock/chal.exe.xz"]}, {"name": "Mortal Kobat", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Mortal_Kobat/MortalKombat"]}, {"name": "Network Configuration", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/TyphoonCon/2021/rev/Network_Configuration/bin"]}]}