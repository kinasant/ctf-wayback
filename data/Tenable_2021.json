{"code": [{"name": "IsTheKingInCheck", "desc": "We have several chess matches on an 8x8 board needing to know if either king is in check or not. Below is some starter code that reads some chess board data from several chess matches.\n\n'''\nTakes '+' and ' ' delimited data of chess matches and parses into list of seperate matches\n''' \ndef ParseMatches(chess_matches):\n    return [c.split('+') for c in chess_matches.split(' ')]\n\n'''\n:param chess_match: A list of chess pieces and their location on the board. ie: ['w,p,a2', 'w,q,a6','w,k,c1','b,r,h1','b,k,g3']\n:return: returns True or False if a King is in check\n'''\ndef IsKingInCheck(chess_match):\n    # impliment code\n\n# Parses chess matches from raw_input and calls \"IsKingInCheck\" for each match. Result is then printed\nresult = []\nchess_matches = ParseMatches(raw_input())\nfor chess_match in chess_matches:\n    result.append(IsKingInCheck(chess_match))\n    \nprint result\n\nImpliment \"IsKingInCheck\" function which takes a single matches' chess data and returns True if the one of the Kings are in check (or checkmate), otherwise False. The single matches' chess data will be a list of pieces and their location on the board in the format of [\"color, rank, cordinates\"].\n\nExample [\"w,p,a2\", \"w,q,b6\", \"w,r,h2\", \"w,k,c1\", \"w,p,c7\", \"w,p,g7\", \"w,p,e6\", \"b,k,d7\", \"b,p,e6\", \"b,r,a6\",]\n\nColor\n\n    \"b\" = Black\n    \"w\" = White\n\nRank\n\n    \"q\" = Queen\n    \"k\" = King\n    \"b\" = Bishop\n    \"r\" = Rook\n    \"n\" = Knight\n    \"p\" = Pawn\n\nCordinates\n\n    This describes where the piece currently is on the board and will be in typical chess cordinates, such as \"a6\" or \"b7\", as seen on a labeled chess board.\n\nIn this chess game, White opponent starts at the lower numbers of the board cordinates and Black opponent at higher cordinates.\n\nstdin example:\n\nw,p,c6+w,q,c8+w,p,g7+w,k,e5+b,b,b2+b,p,f3+b,k,f1\nw,p,c4+w,r,a6+w,p,e6+w,p,h6+w,p,g7+w,k,h5+b,r,b2+b,p,f3+b,k,c2\n\nstdout example:\n\n[True, False]\n\nYou can ignore the default code below and instead use code above. Once function is implemented, simply copy/paste into box and run. Ensure not to print anything else during your code execution!\n"}, {"name": "RandomEncryption", "desc": "\n\nWe found the following file on a hacked terminal:\n\nimport random\nflag = \"flag{n0t_that_r4ndom}\"\nseeds = []\nfor i in range(0,len(flag)):\n    seeds.append(random.randint(0,10000))\n\nres = []\nfor i in range(0, len(flag)):\n    random.seed(seeds[i])\n    rands = []\n    for j in range(0,4):\n        rands.append(random.randint(0,255))\n\n    res.append(ord(flag[i]) ^ rands[i%4])\n    del rands[i%4]\n    print(str(rands))\n\nprint(res)\nprint(seeds)\n\nWe also found sample output from a previous run:\n\n[22, 67, 142]\n[57, 51, 53]\n[97, 114, 14]\n[16, 94, 107]\n[187, 79, 172]\n[138, 138, 118]\n[32, 41, 8]\n[93, 104, 248]\n[112, 33, 215]\n[22, 163, 8]\n[170, 21, 156]\n[183, 196, 255]\n[62, 160, 64]\n[93, 124, 68]\n[53, 227, 187]\n[234, 44, 74]\n[96, 171, 138]\n[161, 46, 45]\n[186, 114, 154]\n[188, 137, 120]\n[239, 44, 13]\n[209, 17, 111, 78, 180, 98, 205, 186, 202, 124, 139, 37, 57, 95, 47, 136, 114, 168, 139, 204, 165]\n\nCan you decode it?\n\n"}, {"name": "RandomEncryptionFixed", "desc": "\n\nWe found the following file on a hacked terminal:\n\nimport random\nflag = \"flag{not_the_flag}\"\nseeds = []\nfor i in range(0,len(flag)):\n    seeds.append(random.randint(0,10000))\n\nres = []\nfor i in range(0, len(flag)):\n    random.seed(seeds[i])\n    rands = []\n    for j in range(0,4):\n        rands.append(random.randint(0,255))\n\n    res.append(ord(flag[i]) ^ rands[i%4])\n    del rands[i%4]\n    print(str(rands))\n\nprint(res)\nprint(seeds)\n\nWe also found sample output from a previous run:\n\n[249, 182, 79]\n[136, 198, 95]\n[159, 167, 6]\n[223, 136, 101]\n[66, 27, 77]\n[213, 234, 239]\n[25, 36, 53]\n[89, 113, 149]\n[65, 127, 119]\n[50, 63, 147]\n[204, 189, 228]\n[228, 229, 4]\n[64, 12, 191]\n[65, 176, 96]\n[185, 52, 207]\n[37, 24, 110]\n[62, 213, 244]\n[141, 59, 81]\n[166, 50, 189]\n[228, 5, 16]\n[59, 42, 251]\n[180, 239, 144]\n[13, 209, 132]\n[184, 161, 235, 97, 140, 111, 84, 182, 162, 135, 76, 10, 69, 246, 195, 152, 133, 88, 229, 104, 111, 22, 39]\n[9925, 8861, 5738, 1649, 2696, 6926, 1839, 7825, 6434, 9699, 227, 7379, 9024, 817, 4022, 7129, 1096, 4149, 6147, 2966, 1027, 4350, 4272]\n\n\n"}, {"name": "WeNeedAnEmulator", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/code/WeNeedAnEmulator/Crypto.asm"], "desc": "\n\nAttached is some some never-before-seen assembly code routine that we pulled off a processor which is responsible for string decryption. An input string is put into TRX register, then the routine is run, which decrypts the string.\n\nFor example, when putting UL\\x03d\\x1c'G\\x0b'l0kmm_ string in TRX and executing this code, the resulting string in TRX is decrypted as 'tenable.ctfd.io'.\n\nA few things we know about this assembly:\n\n    There are only two registers, DRX and TRX. These are used to hold variables throughout the runtime.\n\n    Operand order is similar to the AT&T syntax ,which has destination operand first and source operand 2nd ie: MOV DRX, \"dogs\", puts the string \"dogs\" into DRX register/variable. XOR TRX, DRX, xors the string held in DRX with the string in TRX and stores the result in TRX register/variable.\n\n    There are only three instructions that this processor supports:\n\n        XOR - XORs the destination string against a source string and stores the result in the destination string operand. The source string operand can be either literal string or string held in a register/variable. Destination operand is always register. XORs all characters against target string characters starting with beginning chars. Below is an example.\n\n          \tDRX = \"dogs\"\n          \tTRX = \"shadow\"\n          \t\n          \tXOR TRX, DRX\n\n    TRX would become \\x17\\x07\\x06\\x17ow\n        MOV - Simply copies the string from a source operand to the destination operand, the source string operand can be either literal or in another register as a variable.\n        REVERSE - This only takes one operand, and simply reverses the string. ie: if DRX holds \"hotdog\" then \"REVERSE DRX\" turns DRX into \"godtoh\". The operand for this can only be a register.\n\nWhat we need We need an emulator that can execute the code in the attached file in order to decrypt this string...\n\nGED\\x03hG\\x15&Ka =;\\x0c\\x1a31o*5M\n\nIf you successfully develop an emulator for this assembly and initialize TRX with this string, execution should yield a final result in the TRX register.\n\n"}], "crypto": [{"name": "ClassicCrypto", "desc": "\n\nTusec mfy eaam gfqclaef oomgh ok. Tuog uq\u2019fy snnfpfugnk, kvrf, adotq fvzz-zgtzk tuog qmk ife gcb kmbs kucsefqfi eoiwrq. Fvy lrhhu ge, ky srr oyj fvyke gvvlsg. Ufoamzmgg ck a fmzzaz, fakr huc rzuy a pchlffs xlvsf. Rts zdat wf rts mqmocy mr hbw cbiardm. Imr zofie olw ohf ayfwifay wqczhcly. Js npq bil Aacawycok \u2013 wr frndsmwng huc uryslf cs Yzchqmbif. Rdinz, fesrbaa ufd gvr pqainay cs aqbmgrfvvn. Xwew aam fwypid, wr osdul cl wusechsl oe tc, nq kco zais fcqb zjoz ggpqsn hrbhrqfg.\n\nQw hnjr la zysdrff, aujcdinbf md giddvseq. Is uje nzy mzs. Qw rhb bnqfulibbf zqqumsr huyf wm ohnh gfq ulguc rrauryk tb rb. Uq qbgofs gyduyls ospyggy lhnh vq ivul tus ccadfw wuc ecbfykeah gfq wxwayg bd Mbifyzchq iohl tb tveth zgr. Gvr uaffv if wa rdcotlr. Kr qqs cl eisew pos \u2013 oae, dbtqfnq, mhfqcd. Spwrl rnw is uje oczzmfxwd jwgf zsqk aar vkmuyk, af kr quh ul hbar qmty an gvr izcqdequr rton oe nfr nakyjlrgf, rton \u201cteghrp\u201d ywhvs nfr bqofant kvrt hbw svhhyfwif.\n\nBhh jfmh cx ybi pmgzx te gvr atohye lch umbn lo fsr? G\u2019y hqwngm sghs swaeg bjp. W qwng hb qovigl nbq aazfwgr. W smgubl fbf zw ocoftem gfqb agt n xbz mbx havr zw forws. Vt lmg ayl mr ca rts mlrrsg G icodda\u2019h rtqb lwgvggcd ch qohf eypol. A az xhqf ohgtuse nqfmgn vb n qqo ix fnqrq.\n\nNin an pmocdgjscr kr yds xafsseczh. Qw hrzccp tlwe gvr nqcjde bt Rekdn. Oe usynqr zaguh nemwhkt Vgeyqz uk ig ogrqajleq urlaqcve. Js rvbcmwd zcec fvuf fvtgw fvimsnbq nmsxgpuwyce olguar gfq kijlq. Kr daiazt gvr bdia uaehrje. Ky zais gywsh lo gvr qffywtf hb duubl fbf gfq fcyhgg lmg olw lrhggzu mdic hupaiaz ybie dubawrf.\n\nKr yds Ufoamzmgg.\n\nNze szne ug \"zdat{qyyegcuvvurlqfy}\"\n\nAn gcqyk\u2019g qgryr jc mfy kerb nq fsljoewfre cl st osfr pohyeechq mbujcuwfre. Ky\u2019je poyjqr \u201cwgwnfqq\u201d mbx \u201chofseq\u201d rcl ziqwae nsbanq anqwg, vmt jvb ge hbw rroy nagyj? Wr hniq oqsy gvr dmqy snq zryhs ifll huc ysmkats. Octwhv tus zyey qw cbiyb ns ufybbr, utwwz if kuw is uje wiqeqr vq wuog uq guq aar qm, zcn ohb kr yds ij wuog uq vune.\n\nJs rvugn oigvbsf bulibbnjuhs, kkvb pmxcoj oe frjuucguf pvye.\n\n"}, {"name": "ECDSAImplementationReview", "desc": "\n\nWe found the following code and an output file. Can you extract the flag from the output file?\n\nimport ecdsa\nimport random\nfrom Crypto.Cipher import AES\nimport binascii\n\ndef pad(m):\n    return m+chr(16-len(m)%16)*(16-len(m)%16)\n\ngen = ecdsa.NIST256p.generator\norder = gen.order()\nsecret = random.randrange(1,order)\n \npub_key = ecdsa.ecdsa.Public_key(gen, gen * secret)\npriv_key = ecdsa.ecdsa.Private_key(pub_key, secret)\n \nnonce1 = random.randrange(1, 2**127)\nnonce2 = nonce1\n \n# randomly generate hash value\nhash1 = random.randrange(1, order)\nhash2 = random.randrange(1, order)\n \nsig1 = priv_key.sign(hash1, nonce1)\nsig2 = priv_key.sign(hash2, nonce2)\n\ns1 = sig1.s\ns2 = sig2.s\n\nprint(\"r: \" + str(sig1.r))\nprint(\"s1: \" + str(s1))\nprint(\"s2: \" + str(s2))\nprint(\"\")\nprint(\"hashes:\")\nprint(hash1)\nprint(hash2)\nprint(\"\")\nprint(\"order: \" + str(order))\nprint(\"\")\n\naes_key = secret.to_bytes(64, byteorder='little')[0:16]\n\nptxt =  pad(\"flag{example}\")\nIV = b'\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0'\ncipher = AES.new(aes_key, AES.MODE_CBC, IV)\nctxt = cipher.encrypt(ptxt.encode('utf-8'))\n\nprint(\"Encrypted Flag:\")\nprint(binascii.hexlify(ctxt))\n\nOutput File Contents:\n\nr: 50394691958404671760038142322836584427075094292966481588111912351250929073849\ns1: 26685296872928422980209331126861228951100823826633336689685109679472227918891\ns2: 40762052781056121604891649645502377037837029273276315084687606790921202237960\n\nhashes:\n777971358777664237997807487843929900983351335441289679035928005996851307115\n91840683637030200077344423945857298017410109326488651848157059631440788354195\n\norder: 115792089210356248762697446949407573529996955224135760342422259061068512044369\n\nEncrypted Flag:\nb'f3ccfd5877ec7eb886d5f9372e97224c43f4412ca8eaeb567f9b20dd5e0aabd5'\n\n\n"}, {"name": "EasyPeasy", "desc": "NzMgNzkgNmUgNzQgN2IgNzAgNjIgNjEgNzQgNjUgNmUgNjcgNjYgNWYgNmMgNjIgNjggNWYgNzQgNjIgNjcgNWYgN2EgNzIgN2Q=\n"}], "pwn": [{"name": "EveningCityPD", "desc": "A client is trying to get their hands on a top secret doc located on a remote ECPD case notes terminal. Can you help retrieve it?\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/pwn/EveningCityPD/ecpd"]}, {"name": "GambitQueens", "desc": "Remy set up a blackjack server where friends and students can win Xavier coins to spend around the campus, but someone broke in and stole a bunch of coins (he thinks it was Silas Burr) and he needs help figuring out how.\n\nnc challenges.ctfd.io 30466\n\nHank didn't have time to figure it out, but he said this may come in handy: https://libc.nullbyte.cat/\n\nif you're having trouble maintaining a shell, try using cat to keep stdin open:\n\n#(cat ./exploit ; cat - ) | nc xxxx yy\n\nor\n\n#(python sploit.py ; cat - ) | nc xxxx yy\n\netc...\n\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/pwn/GambitQueens/cards"]}, {"name": "QueenGambit", "desc": "Practice your moves on Mr. Shaibel's chess server!\n\nif you're having trouble maintaining a shell, try using cat to keep stdin open:\n\n#(cat ./exploit ; cat - ) | nc xxxx yy\n\nor\n\n#(python sploit.py ; cat - ) | nc xxxx yy\n\netc...\n\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/pwn/QueenGambit/chess"]}, {"name": "WelcomeToTheFriendzone", "desc": "There is a social media command line service running here. It needs to be exploited in order to view a certain profile. It will require a pretty obscure exploit, but I think you can do it. Attached is the source code, hope that helps.\n", "attach": [null]}], "rev": [{"name": "HackerManifesto", "desc": "\n\nWe found this file on a compromised host. It appears to contain data, but we're not sure how to decode it. Maybe you can figure it out?\n\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/rev/HackerManifesto/hacker_manifesto.txt"]}, {"name": "Pwntown1", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/rev/Pwntown1/GameAssembly.dll", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/rev/Pwntown1/UnityCrashHandler64.exe.xz", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/rev/Pwntown1/UnityPlayer.dll", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/rev/Pwntown1/pwntown.exe.xz", null], "desc": "\n\nI've been trying to make a video game. It's pretty rough around the edges right now. Character sprites don't always cooperate, one of the character classes can't even attack yet, but I'm pretty proud of it so far. I made it using Unity, a starter package called uMMORPG, and a bunch of assets from the public domain.\n\nIt's really difficult, but I'm sure a hacker such as yourself won't have any problem figuring it out. ;)\n\nThe flag for this challenge can be obtained by winning the coridoor race.\n\n"}, {"name": "Pwntown2", "desc": "\n\nI've been trying to make a video game. It's pretty rough around the edges right now. Character sprites don't always cooperate, one of the character classes can't even attack yet, but I'm pretty proud of it so far. I made it using Unity, a starter package called uMMORPG, and a bunch of assets from the public domain.\n\nIt's really difficult, but I'm sure a hacker such as yourself won't have any problem figuring it out. ;)\n\nThe flag for this challenge can be obtained by getting onto the secret island.\n\n"}, {"name": "Pwntown3", "desc": "\n\nI've been trying to make a video game. It's pretty rough around the edges right now. Character sprites don't always cooperate, one of the character classes can't even attack yet, but I'm pretty proud of it so far. I made it using Unity, a starter package called uMMORPG, and a bunch of assets from the public domain.\n\nIt's really difficult, but I'm sure a hacker such as yourself won't have any problem figuring it out. ;)\n\nThe flag for this challenge can be obtained by finding the hidden message in the ocean.\n\n"}, {"name": "Pwntown4", "desc": "\n\nI've been trying to make a video game. It's pretty rough around the edges right now. Character sprites don't always cooperate, one of the character classes can't even attack yet, but I'm pretty proud of it so far. I made it using Unity, a starter package called uMMORPG, and a bunch of assets from the public domain.\n\nIt's really difficult, but I'm sure a hacker such as yourself won't have any problem figuring it out. ;)\n\nThe flag for this challenge can be obtained by completing Questy McQuestgiver's quest.\n\n"}, {"name": "The only tool you will ever need", "desc": "\n\nDo you know how to use the most powerful reversing tool on the planet?\n\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/rev/The_only_tool_you_will_ever_need/a.out"]}], "web": [{"name": "PharOut", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/PharOut/Dockerfile", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/PharOut/doit.php", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/PharOut/index.php", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/PharOut/php.ini", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/PharOut/ports.conf", null, "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/PharOut/wrapper.php"], "desc": "\n\nFind the vulnerability using the provided source code. Dockerfile included.\n\nExploit the vulnerability in http://challenges.ctfd.io:30455 to recover the flag. Please, no scanners, brute force, DoS against the live site.\n\nServer is Ubuntu/Apache2/PHP7.4\n\n"}, {"name": "SpringMVC1", "desc": "\n\nAttached is a zip archive containing the source code of a Spring MVC Java web application. Download and extract the archive.\n\nThe goal is for you to analyze the code and construct HTTP requests to either (There are multiple sites due to high traffic volume):\n\n    http://challenges.ctfd.io:30542/\n    http://challenges.ctfd.io:30541/\n    http://challenges.ctfd.io:30543/\n\nThis could be accomplished using a web proxy tool such as OWASP ZAP or Burp Suite or your favorite scripting language. It's up to you how you retrieve the flags. Please, no automated scanners or denial of service. Be nice to the application! This is an exercise in precision.\n\nIf you would like to run the application locally, inside you'll find a README which instructs you on how to run the application. A pre-built WAR has been provided. The app was created and tested in the following environment:\n\nUbuntu 20.04 LTS Release: 20.04 openjdk 14.0.2 2020-07-14 OpenJDK Runtime Environment (build 14.0.2+12-Ubuntu-120.04) OpenJDK 64-Bit Server VM (build 14.0.2+12-Ubuntu-120.04, mixed mode, sharing)\n\nWhen in doubt, read the Spring framework docs!\n\nNote: The flags in the provided source code have been changed in the live app.\n\n", "attach": ["https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/SpringMVC1/mvc-0.0.1-SNAPSHOT.war", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/SpringMVC1/mvnw", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/SpringMVC1/mvnw.cmd", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/SpringMVC1/pom.xml", "https://raw.githubusercontent.com/sajjadium/ctf-archives/main/ctfs/Tenable/2021/web/SpringMVC1/readme.txt", null]}]}